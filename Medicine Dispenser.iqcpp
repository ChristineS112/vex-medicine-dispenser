{"mode":"Text","hardwareTarget":"brain","textContent":"#pragma region VEXcode Generated Robot Configuration\n// Make sure all required headers are included.\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdbool.h>\n#include <math.h>\n#include <string.h>\n\n\n\n\n#include \"vex.h\"\n\n\nusing namespace vex;\n\n\n// Brain should be defined by default\nbrain Brain;\n\n\n\n\n// START IQ MACROS\n#define waitUntil(condition)                                                   \n  do {                                                                         \n    wait(5, msec);                                                             \n  } while (!(condition))\n\n\n#define repeat(iterations)                                                     \\\n  for (int iterator = 0; iterator < iterations; iterator++)\n// END IQ MACROS\n\n\n\n\n// Robot configuration code.\ninertial BrainInertial = inertial();\nmotor MotorTilt = motor(PORT1, true);\nmotor MotorDispense = motor(PORT2, false);\ntouchled TouchLED7 = touchled(PORT7);\nbumper Bumper5 = bumper(PORT5);\nmotor MotorDrawer = motor(PORT3, true);\ndistance Distance6 = distance(PORT6);\n\n\n\n\n// generating and setting random seed\nvoid initializeRandomSeed(){\n  wait(100,msec);\n  double xAxis = BrainInertial.acceleration(xaxis) * 1000;\n  double yAxis = BrainInertial.acceleration(yaxis) * 1000;\n  double zAxis = BrainInertial.acceleration(zaxis) * 1000;\n  // Combine these values into a single integer\n  int seed = int(\n    xAxis + yAxis + zAxis\n  );\n  // Set the seed\n  srand(seed);\n}\n\n\n\n\n\n\nvoid vexcodeInit() {\n\n\n  // Initializing random seed.\n  initializeRandomSeed();\n}\n\n\n#pragma endregion VEXcode Generated Robot Configuration\n\n\n// Include the IQ Library\n#include \"iq_cpp.h\"\n\n\n// Allows for easier use of the VEX Library\nusing namespace vex;\n\n\n//function prototypes\n\n\nvoid configureAllSensors();\nvoid waitForTouchLED();\nint setAlarm();\nvoid waitForBumper();\nvoid playAlarm();\nvoid alertRefill();\nvoid dispense();\nvoid drawer(int direction);\nbool generateReport (int countTouchSensor);\nvoid printReport (bool missedTimes, int numMissedTimes);\n\n\n\n\nvoid configureAllSensors(){\n  BrainInertial.calibrate();\n  wait(2,seconds);\n  BrainInertial.setHeading(0,degrees);\n  BrainInertial.setRotation(0,degrees);\n  MotorTilt.setPosition(0,turns);\n  MotorDispense.setPosition(0,turns);\n  MotorDrawer.setPosition(0,turns);\n  Brain.Screen.clearScreen();\n  Brain.Screen.setFont(mono15);\n}\n\n\nint setAlarm() {\n  Brain.Screen.clearScreen();\n  Brain.Screen.setCursor(1,1);\n  Brain.Screen.print(\"Press bumper\");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"to set alarm\");\n  Brain.Screen.newLine();\n  waitForBumper();\n  int num_hours = 0;\n \n  Brain.Screen.clearScreen();\n  Brain.Screen.setCursor(1,1);\n  Brain.Screen.print(\"Number of hours: %d\", num_hours);\n  wait(0.5, seconds);\n\n\n  while(!TouchLED7.pressing())\n  {\n    if(Bumper5.pressing())\n    {\n      wait(15, msec);\n      Brain.Screen.setCursor(1,1);\n      num_hours++;\n      Brain.Screen.clearScreen();\n      Brain.Screen.print(\"Number of hours: %d\", num_hours);\n      wait(0.5, seconds);\n    }\n  }\n  int num_minutes = 0;\n  Brain.Screen.clearScreen();\n  Brain.Screen.setCursor(1,1);\n \n  while(TouchLED7.pressing())\n  {}\n\n\n  while(!TouchLED7.pressing())\n  {\n     \n    Brain.Screen.setCursor(1,1);\n    Brain.Screen.print(\"Minutes: %d\", num_minutes);\n    if(Bumper5.pressing())\n    {\n      Brain.Screen.clearScreen();\n      Brain.Screen.setCursor(1,1);\n      num_minutes+= 1;\n      Brain.Screen.print(\"Minutes: %d\", num_minutes);\n      wait(0.3, seconds);\n    }\n  }\n  Brain.Screen.clearScreen();\n  Brain.Screen.setCursor(1,1);\n  Brain.Screen.print(\"Press TouchLED to \");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"set alarm for \");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"%d hrs, %d min\", num_hours, num_minutes);\n  wait(1, seconds);\n  waitForTouchLED();\n\n\n  /*\n  1 minute = 1 second\n  1 hour = 5 seconds\n  */\n  int time_set_in_mins = num_hours*5 + num_minutes;\n  return time_set_in_mins;\n}\n\n\nvoid waitForBumper() {\n    while(!Bumper5.pressing())\n    {}\n    while(Bumper5.pressing())\n    {}\n}\n\n\nvoid waitForTouchLED() {\n    while(!TouchLED7.pressing())\n    {}\n    while(TouchLED7.pressing())\n    {}\n}\n\n\nvoid playAlarm()\n{\n  Brain.Screen.clearScreen();\n  Brain.Screen.setCursor(1,1);\n  Brain.Screen.print(\"1. Dispense medicine: \");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"press Touch Sensor\");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"2. Skip medicine: \");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"press bumper\");\n  Brain.Screen.newLine();\n\n\n  Brain.playNote(4, 4, 250);\n  Brain.playNote(4, 4, 250);\n  Brain.playNote(4, 2, 250);\n  Brain.playNote(4, 0, 250);\n  Brain.playNote(4, 3, 250);\n  Brain.playNote(4, 2, 250);\n  Brain.playNote(4, 2, 500);\n  Brain.playNote(4, 0, 250);\n  Brain.playNote(4, 2, 250);\n  Brain.playNote(4, 3, 250);\n  Brain.playNote(4, 2, 250);\n  Brain.playNote(4, 0, 500);\n  wait(0.5, seconds);\n}\n\n\nvoid alertRefill()\n{\n \n  Brain.Screen.clearScreen();\n  Brain.Screen.setCursor(1,1);\n  Brain.Screen.print(\"Time to refill dispenser\");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"Do not forget to put screen back\");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"to prevent pills from spilling\");\n  MotorTilt.spin(forward, 20, pct);\n  while (MotorTilt.position(degrees) < 70)\n  {}\n  MotorTilt.stop();\n \n  Brain.playNote(4, 0, 250);\n  Brain.playNote(4, 2, 250);\n  Brain.playNote(4, 4, 250);\n  Brain.playNote(4, 0, 250);\n  Brain.playNote(3, 5, 250);\n  Brain.playNote(3, 6, 250);\n  Brain.playNote(4, 0, 500);\n\n\n  Brain.playNote(3, 5, 250);\n  Brain.playNote(3, 5, 250);\n  Brain.playNote(4, 2, 250);\n  Brain.playNote(4, 4, 250);\n  Brain.playNote(4, 0, 500);\n}\n\n\nvoid dispense()\n{\n  MotorDispense.spin(forward, 10, percent);\n  while(MotorDispense.position(degrees) < 23)\n  {}\n  MotorDispense.stop(brake);\n  MotorDispense.setPosition(0, degrees);\n  wait(0.5,seconds);\n}\n\n\nvoid drawer(int direction)\n{\n  if (direction == 0) // Extend\n  {\n    MotorDrawer.spin(forward, 25, pct);\n    while (MotorDrawer.position(degrees) < 45)\n    {}\n    MotorDrawer.stop();\n    MotorDrawer.setPosition(0, degrees);\n  }\n  else if (direction == 1) // Retract\n  {\n    MotorDrawer.spin(reverse, 25, pct);\n    while (MotorDrawer.position(degrees) > -45)\n    {}\n    MotorDrawer.stop();\n    MotorDrawer.setPosition(0, degrees);\n  }\n}\n\n\nbool generateReport (int countTouchSensor)\n{\n    bool hasSkipped = false;\n    if ( countTouchSensor >= 1)\n    {\n        hasSkipped = true;\n    }\n    return hasSkipped;\n}\n\n\nvoid printReport (bool missedTimes, int numMissedTimes)\n{\n  if (missedTimes == false)\n  {\n    Brain.Screen.clearScreen();\n    Brain.Screen.setCursor(1,1);\n    Brain.Screen.print(\"You missed none\");\n    Brain.Screen.newLine();\n    Brain.Screen.print(\"of the medication!\");\n    Brain.Screen.newLine();\n  }\n  else if (missedTimes == true)\n  {\n    Brain.Screen.clearScreen();\n    Brain.Screen.setCursor(1,1);\n    Brain.Screen.print(\"You have missed\");\n    Brain.Screen.newLine();\n    Brain.Screen.print(\"medication %d times\", numMissedTimes);\n  }\n}\n\n\n\n\nint main()\n{\n  // Initializing Robot Configuration. DO NOT REMOVE!\n  vexcodeInit();\n  configureAllSensors();\n  // Repeat until dispenser is empty\n\n\n  int skipCounter = 0;\n  int time = setAlarm();\n  Brain.Timer.reset();\n  Brain.Screen.clearScreen();\n  Brain.Screen.setCursor(1,1);\n  Brain.Screen.print(\"Timer has\");\n  Brain.Screen.newLine();\n  Brain.Screen.print(\"been set!\");\n\n\n  // Set as 5 for the purpose of the demo\n  for(int i = 0; i < 3; i++)\n  {\n    while(Brain.Timer.value() < time)\n    {}\n    playAlarm(); // Already has if bumper pressing then jingle stops\n\n\n    while(!Bumper5.pressing() && !TouchLED7.pressing())\n    {}\n    bool skipping = false;\n    if (Bumper5.pressing())\n    {\n      skipCounter += 1;      \n      skipping = true;\n    }  \n    else if (TouchLED7.pressing())\n    {\n      dispense();\n      Brain.Screen.clearScreen();\n      Brain.Screen.setCursor(1,1);\n      Brain.Screen.print(\"Medicine dispensed!\");\n      drawer(0);\n    }\n   \n    bool hasSkipped = generateReport(skipCounter);\n    printReport(hasSkipped, skipCounter);\n    waitForTouchLED();\n    wait(1, msec); // apply wait time so the text erases properly\n    Brain.Screen.clearScreen();\n    Brain.Screen.setCursor(1,1);\n    time = setAlarm();\n\n\n    Brain.Timer.reset();\n    Brain.Screen.clearScreen();\n    Brain.Screen.newLine();\n    Brain.Screen.setCursor(1,1);\n    Brain.Screen.print(\"Timer has\");\n    Brain.Screen.newLine();\n    Brain.Screen.print(\"been set!\");\n   \n    if(!skipping)\n    {\n      float approx_dist = 30.0;\n      wait(20, msec);\n      while(Distance6.objectDistance(inches) < approx_dist)\n      {}\n      drawer(1);\n    }\n  }\n\n\n  alertRefill();  \n  Brain.programStop();\n  return EXIT_SUCCESS;\n}\n","textLanguage":"cpp","robotConfig":[{"port":[1],"name":"MotorTilt","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"true","fwd":"forward","rev":"reverse"},"triportSourcePort":22},{"port":[2],"name":"MotorDispense","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse"},"triportSourcePort":22},{"port":[7],"name":"TouchLED7","customName":false,"deviceType":"TouchLED","deviceClass":"touchled","setting":{},"triportSourcePort":22},{"port":[5],"name":"Bumper5","customName":false,"deviceType":"Bumper","deviceClass":"bumper","setting":{},"triportSourcePort":22},{"port":[6],"name":"MotorDrawer","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"true","fwd":"forward","rev":"reverse"},"triportSourcePort":22}],"slot":0,"platform":"IQ","sdkVersion":"20230818.11.00.00","appVersion":"4.60.0","fileFormat":"2.0.0","targetBrainGen":"Second","v5SoundsEnabled":false,"aiVisionSettings":{"colors":[],"codes":[],"tags":true,"AIObjects":true,"AIObjectModel":[],"aiModelDropDownValue":""}}